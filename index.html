
<!DOCTYPE html>
<html>
<head>


<script>
  let lastTitle = '';
  let lastDescription = '';
</script>


  <!--====== Required meta tags ======-->
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!--====== Title ======-->
  <title>Beacon MED NU IT</title>

  <!--====== Favicon Icon ======-->
  <link rel="shortcut icon" href="html/images/logo_beacon.png" type="image/png">

  <!--====== Bootstrap css ======-->
  <link rel="stylesheet" href="html/css/bootstrap.min.css">

  <!--====== Line Icons css ======-->
  <link rel="stylesheet" href="html/css/LineIcons.css">

  <!--====== Magnific Popup css ======-->
  <link rel="stylesheet" href="html/css/magnific-popup.css">

  <!--====== Default css ======-->
  <link rel="stylesheet" href="html/css/default.css">

  <!--====== Style css ======-->
  <link rel="stylesheet" href="html/css/style.css">
</head>
<!--====== PRELOADER PART START ======-->

<div class="preloader">
   <div class="loader_34">
       <div class="ytp-spinner">
           <div class="ytp-spinner-container">
               <div class="ytp-spinner-rotator">
                   <div class="ytp-spinner-left">
                       <div class="ytp-spinner-circle"></div>
                   </div>
                   <div class="ytp-spinner-right">
                       <div class="ytp-spinner-circle"></div>
                   </div>
               </div>
           </div>
       </div>
   </div>
</div>

<!--====== PRELOADER ENDS START ======-->

<!--====== HEADER PART START ======-->

<header id="home" class="header-area">
   <div class="navigation fixed-top">
       <div class="container">
           <div class="row ">
               <div class="col-lg-12">
                   <nav class="navbar navbar-expand-lg">
                     <!-- <h1 class="sub-title" style="font-size: 27px;">WELCOME TO DATA CENTER ROOM</h1> -->
                     <img src="html/images/logo_beacon.png" alt="Logo" style="width: 10%; height: auto; float: left;">
                     <h1 class="sub-title" style="font-size: 35px; text-align: left;">WELCOME TO    DATA CENTER ROOM <br>  </h1>
                     
                       <a class="navbar-brand" href="https://www.facebook.com/ITMedNU/">
                        <img src="html/images/fbit.png" alt="Logo" style="width: 100%; height: auto; float: right;">
                       </a> <!-- Logo -->
                       <a class="navbar-brand" href="https://med.nu.ac.th/home/index.php">
                        <img src="html/images/tab_med.png" alt="Logo" style="width: 100%; height: auto; float: right;">
                       </a> <!-- Logo -->
                       <a class="navbar-brand" href="https://med.nu.ac.th/nuh/">
                        <img src="html/images/tab_hospital.png" alt="Logo" style="width: 100%; height: auto; float: right;">
                       </a> <!-- Logo -->
                       <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                           <span class="toggler-icon"></span>
                           <span class="toggler-icon"></span>
                           <span class="toggler-icon"></span>
                       </button>

                       <div class="collapse navbar-collapse" id="navbarSupportedContent">
                           
                       </div> <!-- navbar collapse -->
                   </nav> <!-- navbar -->
               </div>
           </div> <!-- row -->
       </div> <!-- container -->
   </div> <!-- navigation -->

   <div id="parallax" class="header-content d-flex align-items-center">
       <div class="header-shape shape-one layer" data-depth="0.10">
           <img src="html/images/banner/shape/shape-1.png" alt="Shape">
       </div> <!-- header shape -->
       <div class="header-shape shape-tow layer" data-depth="0.30">
           <img src="html/images/banner/shape/shape-2.png" alt="Shape">
       </div> <!-- header shape -->
       <div class="header-shape shape-three layer" data-depth="0.40">
           <img src="html/images/banner/shape/shape-3.png" alt="Shape">
       </div> <!-- header shape -->
       <div class="header-shape shape-fore layer" data-depth="0.60">
           <img src="html/images/banner/shape/shape-2.png" alt="Shape">
       </div> <!-- header shape -->
       <div class="header-shape shape-five layer" data-depth="0.20">
           <img src="html/images/banner/shape/shape-1.png" alt="Shape">
       </div> <!-- header shape -->
       <div class="header-shape shape-six layer" data-depth="0.15">
           <img src="html/images/banner/shape/shape-4.png" alt="Shape">
       </div> <!-- header shape -->
       <div class="header-shape shape-seven layer" data-depth="0.50">
           <img src="html/images/banner/shape/shape-5.png" alt="Shape">
       </div> <!-- header shape -->
       <div class="header-shape shape-eight layer" data-depth="0.40">
           <img src="html/images/banner/shape/shape-3.png" alt="Shape">
       </div> <!-- header shape -->
       <div class="header-shape shape-nine layer" data-depth="0.20">
           <img src="html/images/banner/shape/shape-6.png" alt="Shape">
       </div> <!-- header shape -->
       <div class="header-shape shape-ten layer" data-depth="0.30">
           <img src="html/images/banner/shape/shape-3.png" alt="Shape">
       </div> <!-- header shape -->
       <div class="container">
           <div class="row align-items-center">
               <div class="col-xl-5 col-lg-6">
                   <div class="header-content-right">
                     <h4 class="sub-title" style="font-size: 70px;">Hello, I’m</h4>
                       <h1 id="bannerTitle">Line Beacon</h1>
                       <p id="bannerDescription">Contact Line OA to View.</p>
                       <p id="bannerOcc">JOB Discription</p>
                       <img src="html/images/qr_beacon.png" alt="Logo" style="width: 45%; height: auto; float: left;">
                       
                   </div> <!-- header content right -->
               </div>
               <div class="col-lg-6 offset-xl-1">
                   <!-- <div class="header-image d-none d-lg-block"> -->
                     <div class="image-frame-purple">
                        <!-- <img class="bann_img" id="bannerImage" src="html/images/dkub.jpg" alt="#" style="max-width: 426%; height: 300;"> -->
                        <!-- <img class="bann_img" id="bannerImage" src="html/images/sawaddee.gif" alt="#" style="max-width: 426%; height: 300;">  -->
                        <!-- <img class="bann_img" id="bannerImage" src="html/images/sawaddee.gif" alt="#" style="max-width: 426%; height: 300;" loop autoplay> -->
                       <img class="bann_img" id="bannerImage" src="html/images/1.gif" alt="#" style="max-width: 426%; height: 300; float: right;">
                    
                        <!-- <img src="html/images/.gif" alt="#" style="width: 100%; height: auto;" loop> -->
                  </div>
                     <!-- <img class="bann_img" id="bannerImage" src="html/images/dkub.jpg" alt="#" style="max-width: 426%; height: 300;"> -->

                   </div> <!-- header image -->
               </div>
           </div> <!-- row -->
           
       </div> <!-- container -->
       <div class="header-social">
           <div class="container">
               <div class="row">
                   <div class="col-lg-12">
                       <div class="header-social-icon">
                           
                       </div> <!-- header social -->
                   </div>
               </div> <!-- row -->
           </div> <!-- container -->
       </div> <!-- header social -->
   </div> <!-- header content -->
   <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.1.2/socket.io.js"></script>
</header>

<!--====== HEADER PART ENDS ======-->


<!--====== FOOTER PART START ======-->

<footer id="footer" class="footer-area">
   <div class="footer-widget pt-130 pb-130">
       <div class="container">
           <div class="row justify-content-center">
               <div class="col-lg-8">
                   <div class="footer-content text-center">
                       <a href="index.html">
                        <img src="html/images/logo_beacon.png" alt="Logo" style="width: 20%; height: auto; float: center;">
                       </a>
                       <p class="mt-"> COMEPUTER ENGINEERING 64 <br> Pibulsongkram Rajabhat University </p>
                       <ul>
                        <li><a href="#"><img src="html/images/job.jpg" alt=""></a></li>
                        <li><a href="#"><img src="html/images/jang.jpg" alt=""></a></li>
                        <li><a href="#"><img src="html/images/max.jpg" alt=""></a></li>
                        <li><a href="#"><img src="html/images/pond.jpg" alt=""></a></li>
                        <li><a href="#"><img src="html/images/de.jpg" alt=""></a></li>
                           <!-- <li><a href="https://www.facebook.com/ITMedNU/"><i class="lni-facebook-filled"></i></a></li>
                           <li><a href="#"><i class="lni-twitter-original"></i></a></li>
                           <li><a href="#"><i class="lni-pinterest"></i></a></li>
                           <li><a href="#"><i class="lni-linkedin-original"></i></a></li> -->
                           

                       </ul>
                   </div> <!-- footer content -->
               </div>
           </div> <!-- row -->
       </div> <!-- container -->
   </div> <!-- footer widget -->
   <div class="footer-copyright pb-20">
       <div class="container">
           <div class="row">
               <div class="col-lg-12">
                   <div class="copyright-text text-center pt-20">
                       <!--<p>Copyright © 2022. Template Crafted by <a href="https://uideck.com" rel="nofollow"></a></p>-->
                   </div> <!-- copyright text -->
               </div>
           </div> <!-- row -->
       </div> <!-- container -->
   </div> <!-- footer widget -->
</footer>

<body>

<!-- Modal -->
<div class="modal fade" id="termsModal" tabindex="-1" role="dialog" aria-labelledby="termsModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="termsModalLabel">Terms and Conditions</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <!-- แสดงข้อความแจ้งเตือนหรือเงื่อนไขที่คุณต้องการให้ผู้ใช้ยอมรับ -->
          <p>By using this website, you agree to the terms and conditions stated...</p>
        </div>
        <div class="modal-footer">
          <!-- <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button> -->
          <button type="button" class="btn btn-primary" id="acceptTermsBtn">OK</button>
        </div>
      </div>
    </div>
  </div>
  

  <div id="container">
    <div id="messages"></div>
  </div>
  <a href="#" class="back-to-top"><i class="lni-chevron-up"></i></a>

<!--====== jBACK TOP TOP PART ENDS ======-->
<!--====== jquery js ======-->
<script src="html/js/vendor/modernizr-3.6.0.min.js"></script>
<script src="html/js/vendor/jquery-1.12.4.min.js"></script>

<script>
    $(document).ready(function() {
      // แสดง Modal เมื่อหน้าเว็บโหลดเสร็จ
      $('#termsModal').modal('show');
      
      // เมื่อผู้ใช้กดปุ่ม "OK"
      $('#acceptTermsBtn').on('click', function() {
        // ซ่อน Modal
        $('#termsModal').modal('hide');
      });
    });
    </script>
    

<!--====== Bootstrap js ======-->
<script src="html/js/bootstrap.min.js"></script>


<!--====== Magnific Popup js ======-->
<script src="html/js/jquery.magnific-popup.min.js"></script>

<!--====== Parallax js ======-->
<script src="html/js/parallax.min.js"></script>

<!--====== Counter Up js ======-->
<script src="html/js/waypoints.min.js"></script>
<script src="html/js/jquery.counterup.min.js"></script>


<!--====== Appear js ======-->
<script src="html/js/jquery.appear.min.js"></script>

<!--====== Scrolling js ======-->
<script src="html/js/scrolling-nav.js"></script>
<script src="html/js/jquery.easing.min.js"></script>


<!--====== Main js ======-->
<script src="html/js/main.js"></script>
  
 <script>
    
    // Define original data before accessing DOM elements
    let originalImageUrl, originalTitle, originalDes;
    
    const socket = new WebSocket('wss://beaconcpe.onrender.com');
    // const socket = new WebSocket('wss://8b08-2403-6200-8847-e6cf-7dba-421d-3622-dd94.ngrok.io');
    // socket.addEventListener('open', (event) => {
    //     console.log('WebSocket connected');
    // });
    socket.onopen = (event) => {
      console.log('WebSocket connection opened:');

    };

    // socket.addEventListener('message', (event) => {
    socket.onmessage = (event) => {
        const data = JSON.parse(event.data);
        if (data.type === 'beacon') {
            const bannerImage = document.getElementById('bannerImage');
            const bannerTitle = document.getElementById('bannerTitle');
            const bannerDescription = document.getElementById('bannerDescription');
            const bannerOcc = document.getElementById('bannerOcc');
            // Store original data if not already stored
            if (!originalImageUrl) {
                originalImageUrl = bannerImage.src;
                originalTitle = bannerTitle.textContent;
                originalDes = bannerDescription.textContent;
                originalOcc = bannerOcc.textContent;
            }

            

            // Update user profile data in the HTML
            bannerImage.src = data.pictureUrl;
            bannerImage.width = 350;
            bannerImage.height = 527;
            bannerTitle.textContent = data.displayName;
            bannerDescription.textContent = data.statusMessage;
            bannerOcc.textContent = data.occupplace;
            console.log(data);

            messageDisplay = 'สวัสดีคุณ :'+data.displayName; // เก็บข้อความไว้ในตัวแปร
            const messageDisplayText = `${messageDisplay}`;    
            generateAndPlay();

            // Reset the data after 5 seconds
            setTimeout(() => {
                bannerImage.src = originalImageUrl;
                bannerImage.width = 320;
                bannerImage.height = 270;
                bannerTitle.textContent = originalTitle;
                bannerDescription.textContent = originalDes;
                bannerOcc.textContent = originalOcc;
            }, 10000);
        }
    };
</script>
<script>
    const apiKey = "EA95VIkMJBkVY3Lrhgi4UROQLOGCWbhc";
    //const baseUrl = "https://api.aiforthai.in.th/vaja9/synth_audiovisual";
  const baseUrl = "https://api.aiforthai.in.th/vaja9/synth_audiovisualsssss";
    const generateAudio = async (text, speaker, phraseBreak, audiovisual) => {
      const requestOptions = {
        method: "POST",
        headers: {
          "Apikey": apiKey,
          "Content-Type": "application/json",
        },
        body: JSON.stringify({
          input_text: text,
          speaker: speaker,
          phrase_break: phraseBreak,
          audiovisual: audiovisual,
        }),
      };

      const response = await fetch(baseUrl, requestOptions);
      const responseData = await response.json();
      return responseData;
    };

    const downloadAudio = async (wavUrl) => {
      const requestOptions = {
        method: "GET",
        headers: {
          "Apikey": apiKey,
        },
      };

      const response = await fetch(wavUrl, requestOptions);
      const audioData = await response.arrayBuffer();
      return audioData;
    };
    const generateAndPlay = async () => {
  try {
    
    const text = messageDisplay; // ใช้ข้อความที่เก็บไว้
    const speaker = 1;
    const phraseBreak = 0;
    const audiovisual = 1;

    const audioResponse = await generateAudio(text, speaker, phraseBreak, audiovisual);
    const wavUrl = audioResponse.wav_url;

    const audioData = await downloadAudio(wavUrl);

    const audioContext = new AudioContext();
    const audioBuffer = await audioContext.decodeAudioData(audioData);
    const audioSource = audioContext.createBufferSource();
    audioSource.buffer = audioBuffer;
    audioSource.connect(audioContext.destination);
    audioSource.start();
    console.log(wavUrl);
  } catch (error) {
    console.error("Error:", error);
  }
};

    const textInput = document.getElementById("textInput");
    const generateAndPlayButton = document.getElementById("generateAndPlay");
generateAndPlayButton.addEventListener("click", generateAndPlay);

// textInput.addEventListener("keydown", async (event) => {
//   // Enter (รหัส 13)
//   if (event.keyCode === 13) {
//     generateAndPlay();
//   }
// });

</script>  
</body>
</html>
